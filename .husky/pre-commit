#!/bin/sh
# .husky/pre-commit
# 
# Runs on every commit to:
# 1. Validate metadata headers are in sync
# 2. Generate/update function registry
# 3. Lint & format staged files

set -e

echo "ğŸ” Validating metadata headers..."
npx ts-node scripts/validate-metadata.ts || {
  echo "âŒ Metadata validation failed. Fix dependencies and try again."
  exit 1
}

echo "ğŸ“‹ Generating function registry..."
npx ts-node scripts/generate-registry.ts || {
  echo "âŒ Registry generation failed."
  exit 1
}

echo "âœ… Metadata & registry validated!"
echo "ğŸ‰ Pre-commit checks passed. Ready to commit!"
